<div class="inventory-stocks-page page-container">
  <!-- Inner width -->
  <div class="page-inner">
    <!-- Page header -->
    <div class="page-header">
      <div>
        <p class="page-title mb-0">
          <i class="bi bi-boxes me-2"></i>
          Stock Overview
        </p>
        <small class="text-muted">
          See how much stock you have for each item
        </small>
      </div>
    </div>

    <!-- SUMMARY CARDS -->
    <section class="section summary-section">
      <div class="summary-cards">
        <!-- Total Items -->
        <div class="summary-card total">
          <div class="left-stripe"></div>
          <div class="content">
            <div class="icon-circle">
              <i class="bi bi-box"></i>
            </div>
            <div class="text">
              <div class="label">Total Items</div>
              <div class="value">{{ items.length }}</div>
            </div>
          </div>
        </div>

        <!-- In Stock -->
        <div class="summary-card ok">
          <div class="left-stripe"></div>
          <div class="content">
            <div class="icon-circle">
              <i class="bi bi-check-circle"></i>
            </div>
            <div class="text">
              <div class="label">In Stock</div>
              <div class="value">{{ inStockCount }}</div>
            </div>
          </div>
        </div>

        <!-- Low Stock -->
        <div class="summary-card low">
          <div class="left-stripe"></div>
          <div class="content">
            <div class="icon-circle">
              <i class="bi bi-exclamation-triangle"></i>
            </div>
            <div class="text">
              <div class="label">Low Stock</div>
              <div class="value">{{ lowStockCount }}</div>
            </div>
          </div>
        </div>

        <!-- Out of Stock -->
        <div class="summary-card out">
          <div class="left-stripe"></div>
          <div class="content">
            <div class="icon-circle">
              <i class="bi bi-x-circle"></i>
            </div>
            <div class="text">
              <div class="label">Out of Stock</div>
              <div class="value">{{ outOfStockCount }}</div>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- LEGEND -->
    <section class="section">
      <div class="help-box-inline">
        <i class="bi bi-info-circle"></i>
        <span>
          <strong class="text-danger">Red</strong> = Out of stock |
          <strong class="text-warning">Yellow</strong> = Low stock |
          <strong class="text-success">Green</strong> = Enough stock
        </span>
      </div>
    </section>

    <!-- FILTERS (Angular Material) -->
    <section class="section">
      <div class="filter-bar">
        <!-- Search -->
        <mat-form-field appearance="outline" class="search-field">
          <mat-icon matPrefix>search</mat-icon>
          <input matInput placeholder="Search items..." [(ngModel)]="searchTerm" (ngModelChange)="filterItems()" />
        </mat-form-field>

        <!-- Category filter -->
        <mat-form-field appearance="outline" class="filter-select-field">
          <mat-label>Category</mat-label>
          <mat-select [(ngModel)]="filterCategory" (ngModelChange)="filterItems()">
            <mat-option [value]="''">All Categories</mat-option>
            <mat-option *ngFor="let cat of categories" [value]="cat.id">
              {{ cat.name }}
            </mat-option>
          </mat-select>
        </mat-form-field>

        <!-- Status filter -->
        <mat-form-field appearance="outline" class="filter-select-field">
          <mat-label>Status</mat-label>
          <mat-select [(ngModel)]="filterStatus" (ngModelChange)="filterItems()">
            <mat-option value="all">All Status</mat-option>
            <mat-option value="ok">In Stock</mat-option>
            <mat-option value="low">Low Stock</mat-option>
            <mat-option value="out">Out of Stock</mat-option>
          </mat-select>
        </mat-form-field>
      </div>
    </section>

    <!-- STOCK LIST -->
    <section class="section">
      <div class="stock-list" *ngIf="filteredItems.length; else noItemsTpl">
        <div class="stock-item" *ngFor="
            let item of filteredItems;
            trackBy: trackByItemId
          " [class.status-ok]="getStockStatus(item) === 'ok'" [class.status-low]="getStockStatus(item) === 'low'"
          [class.status-out]="getStockStatus(item) === 'out'">
          <div class="item-info">
            <span class="item-name">{{ item.name }}</span>
            <span class="item-category">
              {{ item.categoryName || 'Uncategorized' }}
            </span>
          </div>

          <div class="stock-info">
            <div class="current-stock">
              <span class="stock-number">
                {{ item.currentStock }}
              </span>
              <span class="unit">
                {{ item.unitName || 'units' }}
              </span>
            </div>
            <div class="stock-meta">
              <span class="min-level">
                Min: {{ item.minStockLevel }}
              </span>
              <span class="status-badge" [ngClass]="'status-' + getStockStatus(item)">
                {{ getStockStatusText(item) }}
              </span>
            </div>
          </div>
        </div>
      </div>

      <ng-template #noItemsTpl>
        <div class="no-items">
          <i class="bi bi-inbox"></i>
          <p>No items found</p>
          <small>Try adjusting your search or filters</small>
        </div>
      </ng-template>
    </section>

    <!-- TOTAL VALUE -->
    <section class="section" *ngIf="filteredItems.length">
      <div class="total-value-bar">
        <span class="label">Total Stock Value:</span>
        <span class="value">
          â‚¹ {{ getTotalValue() | number: '1.2-2' }}
        </span>
      </div>
    </section>
  </div>
</div>