<div class="wizard-wrapper">
    <div class="wizard-container">
        <!-- Header -->
        <div class="wizard-header">
            <div class="header-info">
                <h1>Staff Onboarding</h1>
                <p>Register and configure new staff member profiles for your hostel</p>
            </div>
        </div>

        <div class="wizard-main">
            <!-- Sidebar -->
            <aside class="wizard-sidebar">
                <div class="steps-list">
                    <div class="step-item" *ngFor="let step of steps" [class.active]="activeStep === step.id"
                        [class.completed]="step.status === 'completed'" (click)="setStep(step.id)" matRipple>
                        <div class="step-icon">
                            <i [class]="step.icon" *ngIf="step.status !== 'completed'"></i>
                            <mat-icon *ngIf="step.status === 'completed'">check</mat-icon>
                        </div>
                        <div class="step-content">
                            <span class="step-title">{{step.title}}</span>
                            <span class="step-subtitle">{{step.subtitle}}</span>
                        </div>
                    </div>
                </div>

                <div class="auto-save-banner">
                    <div class="banner-icon"><mat-icon>security</mat-icon></div>
                    <div class="banner-text">
                        <strong>Secure Processing</strong>
                        <p>All staff data is encrypted and handled securely.</p>
                    </div>
                </div>
            </aside>

            <!-- Content Area -->
            <main class="wizard-content">
                <form #staffForm="ngForm">
                    <!-- Step 1: Identity -->
                    <div class="step-view" *ngIf="activeStep === 1">
                        <h2 class="section-title">Identity Details</h2>
                        <div class="form-grid">
                            <div class="form-row">
                                <div class="form-item flex-1">
                                    <label class="field-label">First Name<span class="required">*</span></label>
                                    <mat-form-field appearance="outline" class="full-width">
                                        <input matInput name="firstName"
                                            [(ngModel)]="dataObj.personalInformation.firstName" required
                                            placeholder="Enter first name">
                                    </mat-form-field>
                                </div>
                                <div class="form-item flex-1">
                                    <label class="field-label">Last Name<span class="required">*</span></label>
                                    <mat-form-field appearance="outline" class="full-width">
                                        <input matInput name="lastName"
                                            [(ngModel)]="dataObj.personalInformation.lastName" required
                                            placeholder="Enter last name">
                                    </mat-form-field>
                                </div>
                            </div>

                            <div class="form-row">
                                <div class="form-item flex-1">
                                    <label class="field-label">Date of Birth<span class="required">*</span></label>
                                    <mat-form-field appearance="outline" class="full-width">
                                        <input matInput [matDatepicker]="dbPicker" name="dob"
                                            [(ngModel)]="dataObj.personalInformation.dateOfBirth" required
                                            placeholder="Select DOB">
                                        <mat-datepicker-toggle matSuffix [for]="dbPicker"></mat-datepicker-toggle>
                                        <mat-datepicker #dbPicker></mat-datepicker>
                                    </mat-form-field>
                                </div>
                                <div class="form-item flex-1">
                                    <label class="field-label">Gender<span class="required">*</span></label>
                                    <div class="radio-group-container">
                                        <mat-radio-group name="gender" [(ngModel)]="dataObj.personalInformation.gender"
                                            required>
                                            <mat-radio-button value="MALE">Male</mat-radio-button>
                                            <mat-radio-button value="FEMALE">Female</mat-radio-button>
                                            <mat-radio-button value="OTHERS">Others</mat-radio-button>
                                        </mat-radio-group>
                                    </div>
                                </div>
                            </div>

                            <div class="form-item">
                                <label class="field-label">Aadhar Card Number<span class="required">*</span></label>
                                <mat-form-field appearance="outline" class="full-width">
                                    <input matInput name="aadhar" [(ngModel)]="dataObj.personalInformation.aadhar"
                                        required placeholder="12-digit Aadhar number" maxlength="12">
                                    <mat-icon matPrefix>vignette</mat-icon>
                                </mat-form-field>
                            </div>

                            <div class="photo-upload-section mt-2">
                                <label class="field-label">Identity Proof / Photo</label>
                                <div class="upload-area" matRipple>
                                    <input type="file" #idProofInput accept=".pdf,.jpg,.jpeg,.png" hidden>
                                    <div class="upload-icon-box" (click)="idProofInput.click()">
                                        <mat-icon>add_a_photo</mat-icon>
                                    </div>
                                    <p>Upload Aadhar or ID Proof</p>
                                    <span>PDF, JPG or PNG (max 5MB)</span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Step 2: Contact -->
                    <div class="step-view" *ngIf="activeStep === 2">
                        <h2 class="section-title">Communication Details</h2>
                        <div class="form-grid">
                            <div class="form-row">
                                <div class="form-item flex-1">
                                    <label class="field-label">Primary Mobile Number<span
                                            class="required">*</span></label>
                                    <mat-form-field appearance="outline" class="full-width">
                                        <span matPrefix>+91&nbsp;</span>
                                        <input matInput name="primaryMobile"
                                            [(ngModel)]="dataObj.contactInfo.primaryMobile" required
                                            placeholder="10-digit mobile number">
                                    </mat-form-field>
                                </div>
                                <div class="form-item flex-1">
                                    <label class="field-label">Email Address</label>
                                    <mat-form-field appearance="outline" class="full-width">
                                        <input matInput name="email" [(ngModel)]="dataObj.contactInfo.emailId"
                                            type="email" placeholder="staff@example.com">
                                        <mat-icon matPrefix>email</mat-icon>
                                    </mat-form-field>
                                </div>
                            </div>

                            <div class="emergency-box mt-4">
                                <h3 class="f-15-m mb-3">Emergency Contact (Home/Relative)</h3>
                                <div class="form-row">
                                    <div class="form-item flex-1">
                                        <label class="field-label">Relative Name<span class="required">*</span></label>
                                        <mat-form-field appearance="outline" class="full-width">
                                            <input matInput name="eName"
                                                [(ngModel)]="dataObj.emergencyContactInfo.firstName" required
                                                placeholder="Full name">
                                        </mat-form-field>
                                    </div>
                                    <div class="form-item flex-1">
                                        <label class="field-label">Mobile Number<span class="required">*</span></label>
                                        <mat-form-field appearance="outline" class="full-width">
                                            <span matPrefix>+91&nbsp;</span>
                                            <input matInput name="eMobile"
                                                [(ngModel)]="dataObj.emergencyContactInfo.mobile" required
                                                placeholder="Relative's mobile">
                                        </mat-form-field>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Step 3: Employment & Bank -->
                    <div class="step-view" *ngIf="activeStep === 3">
                        <h2 class="section-title">Work & Bank Profile</h2>
                        <div class="form-grid">
                            <div class="form-row">
                                <div class="form-item flex-1">
                                    <label class="field-label">Hostel Role / Designation<span
                                            class="required">*</span></label>
                                    <mat-form-field appearance="outline" class="full-width">
                                        <mat-select name="role" [(ngModel)]="dataObj.employmentDetails.role" required
                                            placeholder="Select role">
                                            <mat-option value="warden">Hostel Warden</mat-option>
                                            <mat-option value="manager">Property Manager</mat-option>
                                            <mat-option value="caretaker">Caretaker</mat-option>
                                            <mat-option value="cook">Cook / Chef</mat-option>
                                            <mat-option value="security">Security Guard</mat-option>
                                            <mat-option value="cleaner">Housekeeping staff</mat-option>
                                        </mat-select>
                                    </mat-form-field>
                                </div>
                                <div class="form-item flex-1">
                                    <label class="field-label">Shift Type<span class="required">*</span></label>
                                    <mat-form-field appearance="outline" class="full-width">
                                        <mat-select name="shift" [(ngModel)]="dataObj.shiftDetails.shiftType"
                                            (selectionChange)="onShiftChange($event.value)" required
                                            placeholder="Select shift">
                                            <mat-option value="FIRSTSHIFT">Day Shift (08:00 AM - 08:00 PM)</mat-option>
                                            <mat-option value="SECONDSHIFT">Night Shift (08:00 PM - 08:00
                                                AM)</mat-option>
                                        </mat-select>
                                    </mat-form-field>
                                </div>
                            </div>

                            <div class="bank-section-box mt-4">
                                <h3 class="f-15-m mb-3">Salary Account Details</h3>
                                <div class="form-item">
                                    <label class="field-label">Bank Name</label>
                                    <mat-form-field appearance="outline" class="full-width">
                                        <input matInput name="bankName" [(ngModel)]="dataObj.bankDetails.bankName"
                                            placeholder="e.g. HDFC Bank">
                                        <mat-icon matPrefix>account_balance</mat-icon>
                                    </mat-form-field>
                                </div>
                                <div class="form-row">
                                    <div class="form-item flex-2">
                                        <label class="field-label">Account Number</label>
                                        <mat-form-field appearance="outline" class="full-width">
                                            <input matInput name="accNo" [(ngModel)]="dataObj.bankDetails.accountNumber"
                                                placeholder="Enter bank account no">
                                        </mat-form-field>
                                    </div>
                                    <div class="form-item flex-1">
                                        <label class="field-label">IFSC Code</label>
                                        <mat-form-field appearance="outline" class="full-width">
                                            <input matInput name="ifsc" [(ngModel)]="dataObj.bankDetails.ifscCode"
                                                placeholder="IFSC0001234" style="text-transform: uppercase;">
                                        </mat-form-field>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Step 4: Address -->
                    <div class="step-view" *ngIf="activeStep === 4">
                        <h2 class="section-title">Address Details</h2>
                        <div class="form-grid">
                            <h3 class="f-15-m mb-3">Permanent Home Address</h3>
                            <div class="form-item">
                                <label class="field-label">Full Address Line<span class="required">*</span></label>
                                <mat-form-field appearance="outline" class="full-width">
                                    <input matInput name="pAdd1" [(ngModel)]="dataObj.permanentAddress.addressline1"
                                        required placeholder="House No, Street, Village/Town">
                                </mat-form-field>
                            </div>
                            <div class="form-row">
                                <div class="form-item flex-1">
                                    <label class="field-label">City / District<span class="required">*</span></label>
                                    <mat-form-field appearance="outline" class="full-width">
                                        <input matInput name="pCity" [(ngModel)]="dataObj.permanentAddress.city"
                                            required placeholder="City">
                                    </mat-form-field>
                                </div>
                                <div class="form-item flex-1">
                                    <label class="field-label">Pincode<span class="required">*</span></label>
                                    <mat-form-field appearance="outline" class="full-width">
                                        <input matInput name="pZip" [(ngModel)]="dataObj.permanentAddress.zipcode"
                                            required placeholder="6-digit ZIP" maxlength="6">
                                    </mat-form-field>
                                </div>
                            </div>

                            <div class="mt-4 pt-3 border-top">
                                <div class="d-flex align-items-center justify-content-between mb-3">
                                    <h3 class="f-15-m mb-0">Current Address</h3>
                                    <mat-checkbox [(ngModel)]="sameAsPermanent" [ngModelOptions]="{standalone: true}"
                                        (change)="copyPermanentAddress($event)">
                                        Same as permanent address
                                    </mat-checkbox>
                                </div>
                                <div class="form-item" *ngIf="!sameAsPermanent">
                                    <label class="field-label">Temporary Address Line<span
                                            class="required">*</span></label>
                                    <mat-form-field appearance="outline" class="full-width">
                                        <input matInput name="cAdd1" [(ngModel)]="dataObj.currentAddress.addressline1"
                                            required placeholder="Current staying location">
                                    </mat-form-field>
                                </div>
                            </div>
                        </div>
                    </div>
                </form>
            </main>
        </div>

        <!-- Footer -->
        <div class="wizard-footer">
            <button mat-stroked-button color="warn" class="btn-cancel" (click)="backToMain()">
                <mat-icon>close</mat-icon> Cancel
            </button>
            <div class="footer-actions">
                <button mat-stroked-button (click)="prevStep()" [disabled]="activeStep === 1" class="btn-prev">
                    <mat-icon>chevron_left</mat-icon> Previous
                </button>
                <button mat-flat-button class="btn-next" [disabled]="activeStep === steps.length && !staffForm.valid"
                    (click)="nextStep()">
                    <span>{{activeStep === steps.length ? 'Finalize Onboarding' : 'Continue'}}</span>
                    <mat-icon *ngIf="activeStep < steps.length">chevron_right</mat-icon>
                    <mat-icon *ngIf="activeStep === steps.length">person_add_check</mat-icon>
                </button>
            </div>
        </div>
    </div>
</div>