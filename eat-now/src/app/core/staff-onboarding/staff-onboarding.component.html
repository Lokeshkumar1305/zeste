<div class="wizard-wrapper">
    <div class="wizard-container">
        <!-- Header -->
        <div class="wizard-header">
            <div class="header-info">
                <h1>Staff Onboarding</h1>
                <p>Register and configure new staff member profiles for your hostel</p>
            </div>
        </div>

        <div class="wizard-main">
            <!-- Sidebar -->
            <aside class="wizard-sidebar">
                <div class="steps-list">
                    <div class="step-item" *ngFor="let step of steps" [class.active]="activeStep === step.id"
                        [class.completed]="step.status === 'completed'" (click)="setStep(step.id)" matRipple>
                        <div class="step-icon">
                            <i [class]="step.icon" *ngIf="step.status !== 'completed'"></i>
                            <mat-icon *ngIf="step.status === 'completed'">check</mat-icon>
                        </div>
                        <div class="step-content">
                            <span class="step-title">{{step.title}}</span>
                            <span class="step-subtitle">{{step.subtitle}}</span>
                        </div>
                    </div>
                </div>

                <div class="auto-save-banner">
                    <div class="banner-icon"><mat-icon>security</mat-icon></div>
                    <div class="banner-text">
                        <strong>Secure Processing</strong>
                        <p>All staff data is encrypted and handled securely.</p>
                    </div>
                </div>
            </aside>

            <!-- Content Area -->
            <main class="wizard-content">
                <form [formGroup]="staffForm">
                    <!-- Step 1: Identity -->
                    <div class="step-view" *ngIf="activeStep === 1">
                        <h2 class="section-title">Identity Details</h2>
                        <div class="form-grid">
                            <div class="form-row">
                                <div class="form-item flex-1">
                                    <label class="field-label">First Name<span class="required">*</span></label>
                                    <mat-form-field appearance="outline" class="full-width">
                                        <input matInput formControlName="firstName" placeholder="Enter first name">
                                    </mat-form-field>
                                </div>
                                <div class="form-item flex-1">
                                    <label class="field-label">Last Name<span class="required">*</span></label>
                                    <mat-form-field appearance="outline" class="full-width">
                                        <input matInput formControlName="lastName" placeholder="Enter last name">
                                    </mat-form-field>
                                </div>
                            </div>

                            <div class="form-row">
                                <div class="form-item flex-1">
                                    <label class="field-label">Date of Birth<span class="required">*</span></label>
                                    <mat-form-field appearance="outline" class="full-width">
                                        <input matInput [matDatepicker]="dbPicker" formControlName="dateOfBirth"
                                            placeholder="Select DOB">
                                        <mat-datepicker-toggle matSuffix [for]="dbPicker"></mat-datepicker-toggle>
                                        <mat-datepicker #dbPicker></mat-datepicker>
                                    </mat-form-field>
                                </div>
                                <div class="form-item flex-1">
                                    <label class="field-label">Gender<span class="required">*</span></label>
                                    <div class="radio-group-container">
                                        <mat-radio-group formControlName="gender">
                                            <mat-radio-button value="Male">Male</mat-radio-button>
                                            <mat-radio-button value="Female">Female</mat-radio-button>
                                            <mat-radio-button value="Other">Other</mat-radio-button>
                                        </mat-radio-group>
                                    </div>
                                </div>
                            </div>

                            <div class="form-item">
                                <label class="field-label">Aadhar Card Number<span class="required">*</span></label>
                                <mat-form-field appearance="outline" class="full-width">
                                    <input matInput formControlName="aadharNumber" placeholder="12-digit Aadhar number"
                                        maxlength="12">
                                    <mat-icon matPrefix>vignette</mat-icon>
                                </mat-form-field>
                            </div>

                            <div class="photo-upload-section mt-2">
                                <label class="field-label">Profile Photo</label>
                                <div class="upload-area" matRipple (click)="profPhoto.click()">
                                    <input type="file" #profPhoto accept="image/*" hidden
                                        (change)="onProfilePhotoSelect($event)">
                                    <div class="upload-icon-box" *ngIf="!profilePhotoPreview">
                                        <mat-icon>add_a_photo</mat-icon>
                                    </div>
                                    <div class="preview-box" *ngIf="profilePhotoPreview">
                                        <img [src]="profilePhotoPreview" class="photo-preview">
                                    </div>
                                    <p>{{ profilePhotoPreview ? 'Click to change photo' : 'Upload Staff Photo' }}</p>
                                    <span>JPG or PNG (max 2MB)</span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Step 2: Contact -->
                    <div class="step-view" *ngIf="activeStep === 2">
                        <h2 class="section-title">Communication Details</h2>
                        <div class="form-grid">
                            <div class="form-row">
                                <div class="form-item flex-1">
                                    <label class="field-label">Primary Mobile Number<span
                                            class="required">*</span></label>
                                    <mat-form-field appearance="outline" class="full-width">
                                        <span matPrefix>+91&nbsp;</span>
                                        <input matInput formControlName="phone" placeholder="10-digit mobile number">
                                    </mat-form-field>
                                </div>
                                <div class="form-item flex-1">
                                    <label class="field-label">Email Address</label>
                                    <mat-form-field appearance="outline" class="full-width">
                                        <input matInput formControlName="email" type="email"
                                            placeholder="staff@example.com">
                                        <mat-icon matPrefix>email</mat-icon>
                                    </mat-form-field>
                                </div>
                            </div>

                            <div class="emergency-box mt-4">
                                <h3 class="f-15-m mb-3">Emergency Contact</h3>
                                <div class="form-row">
                                    <div class="form-item flex-1">
                                        <label class="field-label">Relative Name<span class="required">*</span></label>
                                        <mat-form-field appearance="outline" class="full-width">
                                            <input matInput formControlName="emergencyContactName"
                                                placeholder="Full name">
                                        </mat-form-field>
                                    </div>
                                    <div class="form-item flex-1">
                                        <label class="field-label">Mobile Number<span class="required">*</span></label>
                                        <mat-form-field appearance="outline" class="full-width">
                                            <span matPrefix>+91&nbsp;</span>
                                            <input matInput formControlName="emergencyContactPhone"
                                                placeholder="Relative's mobile">
                                        </mat-form-field>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Step 3: Employment & Bank -->
                    <div class="step-view" *ngIf="activeStep === 3">
                        <h2 class="section-title">Work & Bank Profile</h2>
                        <div class="form-grid">
                            <div class="form-row">
                                <div class="form-item flex-1">
                                    <label class="field-label">Hostel Role<span class="required">*</span></label>
                                    <mat-form-field appearance="outline" class="full-width">
                                        <mat-select formControlName="role" placeholder="Select role">
                                            <mat-option *ngFor="let role of hostelRoles"
                                                [value]="role">{{role}}</mat-option>
                                        </mat-select>
                                    </mat-form-field>
                                </div>
                                <div class="form-item flex-1">
                                    <label class="field-label">Shift Type<span class="required">*</span></label>
                                    <mat-form-field appearance="outline" class="full-width">
                                        <mat-select formControlName="assignedShift" placeholder="Select shift">
                                            <mat-option *ngFor="let shift of shifts" [value]="shift.name">{{shift.name}}
                                                ({{shift.time}})</mat-option>
                                        </mat-select>
                                    </mat-form-field>
                                </div>
                            </div>

                            <div class="form-item">
                                <label class="field-label">Basic Salary (Monthly)<span class="required">*</span></label>
                                <mat-form-field appearance="outline" class="full-width">
                                    <span matPrefix>â‚¹&nbsp;</span>
                                    <input matInput type="number" formControlName="basicSalary"
                                        placeholder="e.g. 15000">
                                </mat-form-field>
                            </div>

                            <div class="bank-section-box mt-4">
                                <h3 class="f-15-m mb-3">Salary Account Details</h3>
                                <div class="form-item">
                                    <label class="field-label">Bank Name</label>
                                    <mat-form-field appearance="outline" class="full-width">
                                        <input matInput formControlName="bankName" placeholder="e.g. HDFC Bank">
                                        <mat-icon matPrefix>account_balance</mat-icon>
                                    </mat-form-field>
                                </div>
                                <div class="form-row">
                                    <div class="form-item flex-2">
                                        <label class="field-label">Account Number</label>
                                        <mat-form-field appearance="outline" class="full-width">
                                            <input matInput formControlName="accountNumber"
                                                placeholder="Enter bank account no">
                                        </mat-form-field>
                                    </div>
                                    <div class="form-item flex-1">
                                        <label class="field-label">IFSC Code</label>
                                        <mat-form-field appearance="outline" class="full-width">
                                            <input matInput formControlName="ifscCode" placeholder="IFSC0001234"
                                                style="text-transform: uppercase;">
                                        </mat-form-field>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Step 4: Address -->
                    <div class="step-view" *ngIf="activeStep === 4">
                        <h2 class="section-title">Address Details</h2>
                        <div class="form-grid">
                            <h3 class="f-15-m mb-3">Current Address</h3>
                            <div formGroupName="currentAddress">
                                <div class="form-item">
                                    <label class="field-label">Street Address<span class="required">*</span></label>
                                    <mat-form-field appearance="outline" class="full-width">
                                        <input matInput formControlName="street"
                                            placeholder="House No, Street, Landmark">
                                    </mat-form-field>
                                </div>
                                <div class="form-row">
                                    <div class="form-item flex-1">
                                        <label class="field-label">City<span class="required">*</span></label>
                                        <mat-form-field appearance="outline" class="full-width">
                                            <input matInput formControlName="city" placeholder="City">
                                        </mat-form-field>
                                    </div>
                                    <div class="form-item flex-1">
                                        <label class="field-label">Pincode<span class="required">*</span></label>
                                        <mat-form-field appearance="outline" class="full-width">
                                            <input matInput formControlName="pincode" placeholder="6-digit ZIP"
                                                maxlength="6">
                                        </mat-form-field>
                                    </div>
                                </div>
                            </div>

                            <div class="mt-4 pt-3 border-top">
                                <div class="d-flex align-items-center justify-content-between mb-3">
                                    <h3 class="f-15-m mb-0">Permanent Address</h3>
                                    <mat-checkbox formControlName="sameAsCurrentAddress">
                                        Same as current address
                                    </mat-checkbox>
                                </div>
                                <div formGroupName="permanentAddress"
                                    *ngIf="!staffForm.get('sameAsCurrentAddress')?.value">
                                    <div class="form-item">
                                        <label class="field-label">Street Address<span class="required">*</span></label>
                                        <mat-form-field appearance="outline" class="full-width">
                                            <input matInput formControlName="street"
                                                placeholder="House No, Street, Landmark">
                                        </mat-form-field>
                                    </div>
                                    <div class="form-row">
                                        <div class="form-item flex-1">
                                            <label class="field-label">City<span class="required">*</span></label>
                                            <mat-form-field appearance="outline" class="full-width">
                                                <input matInput formControlName="city" placeholder="City">
                                            </mat-form-field>
                                        </div>
                                        <div class="form-item flex-1">
                                            <label class="field-label">Pincode<span class="required">*</span></label>
                                            <mat-form-field appearance="outline" class="full-width">
                                                <input matInput formControlName="pincode" placeholder="6-digit ZIP"
                                                    maxlength="6">
                                            </mat-form-field>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </form>
            </main>
        </div>

        <!-- Footer -->
        <div class="wizard-footer">
            <button mat-stroked-button color="warn" class="btn-cancel" (click)="backToMain()">
                <mat-icon>close</mat-icon> Cancel
            </button>
            <div class="footer-actions">
                <button mat-stroked-button (click)="prevStep()" [disabled]="activeStep === 1" class="btn-prev">
                    <mat-icon>chevron_left</mat-icon> Previous
                </button>
                <button mat-flat-button class="btn-next" [disabled]="activeStep === steps.length && !staffForm.valid"
                    (click)="nextStep()">
                    <span>{{activeStep === steps.length ? 'Finalize Onboarding' : 'Continue'}}</span>
                    <mat-icon *ngIf="activeStep < steps.length">chevron_right</mat-icon>
                    <mat-icon *ngIf="activeStep === steps.length">person_add_check</mat-icon>
                </button>
            </div>
        </div>
    </div>
</div>