<div class="wizard-wrapper">
    <div class="wizard-container">
        <!-- Header -->
        <div class="wizard-header">
            <div class="header-info">
                <h1>Hostel Onboarding</h1>
                <p>Register your hostel on our platform</p>
            </div>
            <div class="header-actions">
                <button mat-stroked-button (click)="saveDraft()" [disabled]="saving">
                    <mat-icon>save</mat-icon> Save Draft
                </button>
            </div>
        </div>

        <div class="wizard-main">
            <!-- Sidebar -->
            <aside class="wizard-sidebar">
                <div class="steps-list">
                    <div class="step-item" *ngFor="let step of steps" [class.active]="activeStep === step.id"
                        [class.completed]="step.status === 'completed'" (click)="setStep(step.id)" matRipple>
                        <div class="step-icon">
                            <i [class]="step.icon" *ngIf="step.status !== 'completed'"></i>
                            <mat-icon *ngIf="step.status === 'completed'">check</mat-icon>
                        </div>
                        <div class="step-content">
                            <span class="step-title">{{step.title}}</span>
                            <span class="step-subtitle">{{step.subtitle}}</span>
                        </div>
                    </div>
                </div>

                <div class="auto-save-banner">
                    <div class="banner-icon"><mat-icon>info</mat-icon></div>
                    <div class="banner-text">
                        <strong>Progress Auto-saved</strong>
                        <p>We've saved your draft automatically.</p>
                    </div>
                </div>
            </aside>

            <!-- Content Area -->
            <main class="wizard-content">
                <!-- Step 1: Owner Details -->
                <div class="step-view" *ngIf="activeStep === 1">
                    <h2 class="section-title">Owner Details</h2>
                    <form [formGroup]="ownerForm" class="form-grid">
                        <div class="form-item">
                            <label class="field-label">Full Name<span class="required">*</span></label>
                            <mat-form-field appearance="outline" class="full-width">
                                <input matInput formControlName="fullName" placeholder="Enter owner's full name">
                                <mat-icon matPrefix>person</mat-icon>
                            </mat-form-field>
                        </div>

                        <div class="form-row">
                            <div class="form-item flex-1">
                                <label class="field-label">Email Address<span class="required">*</span></label>
                                <mat-form-field appearance="outline" class="full-width">
                                    <input matInput formControlName="email" type="email"
                                        placeholder="owner@example.com">
                                    <mat-icon matPrefix>email</mat-icon>
                                </mat-form-field>
                            </div>
                            <div class="form-item flex-1">
                                <label class="field-label">Phone Number<span class="required">*</span></label>
                                <mat-form-field appearance="outline" class="full-width">
                                    <span matPrefix>+91&nbsp;</span>
                                    <input matInput formControlName="phone" placeholder="9876543210" maxlength="10">
                                </mat-form-field>
                            </div>
                        </div>

                        <div class="form-row">
                            <div class="form-item flex-1">
                                <label class="field-label">Aadhar Number</label>
                                <mat-form-field appearance="outline" class="full-width">
                                    <input matInput formControlName="aadharNumber" placeholder="XXXX XXXX XXXX"
                                        maxlength="14">
                                    <mat-icon matPrefix>vignette</mat-icon>
                                </mat-form-field>
                            </div>
                            <div class="form-item flex-1">
                                <label class="field-label">PAN Number</label>
                                <mat-form-field appearance="outline" class="full-width">
                                    <input matInput formControlName="panNumber" placeholder="ABCDE1234F" maxlength="10"
                                        style="text-transform: uppercase;">
                                    <mat-icon matPrefix>badge</mat-icon>
                                </mat-form-field>
                            </div>
                        </div>
                    </form>
                </div>

                <!-- Step 2: Hostel Details -->
                <div class="step-view" *ngIf="activeStep === 2">
                    <h2 class="section-title">Hostel Details</h2>
                    <form [formGroup]="hostelForm" class="form-grid">
                        <div class="form-row">
                            <div class="form-item flex-2">
                                <label class="field-label">Hostel Name<span class="required">*</span></label>
                                <mat-form-field appearance="outline" class="full-width">
                                    <input matInput formControlName="hostelName"
                                        placeholder="e.g., Sunrise PG & Hostel">
                                    <mat-icon matPrefix>business</mat-icon>
                                </mat-form-field>
                            </div>
                            <div class="form-item flex-1">
                                <label class="field-label">Hostel Type<span class="required">*</span></label>
                                <mat-form-field appearance="outline" class="full-width">
                                    <mat-select formControlName="hostelType" placeholder="Select type">
                                        <mat-option value="Boys">Boys Hostel</mat-option>
                                        <mat-option value="Girls">Girls Hostel</mat-option>
                                        <mat-option value="Co-ed">Co-ed (Mixed)</mat-option>
                                    </mat-select>
                                </mat-form-field>
                            </div>
                        </div>

                        <div class="form-item">
                            <label class="field-label">Address Line 1<span class="required">*</span></label>
                            <mat-form-field appearance="outline" class="full-width">
                                <input matInput formControlName="addressLine1" placeholder="Building name, Door no.">
                                <mat-icon matPrefix>location_on</mat-icon>
                            </mat-form-field>
                        </div>

                        <div class="form-row">
                            <div class="form-item flex-1">
                                <label class="field-label">City<span class="required">*</span></label>
                                <mat-form-field appearance="outline" class="full-width">
                                    <input matInput formControlName="city" placeholder="Enter city">
                                </mat-form-field>
                            </div>
                            <div class="form-item flex-1">
                                <label class="field-label">State<span class="required">*</span></label>
                                <mat-form-field appearance="outline" class="full-width">
                                    <mat-select formControlName="state" placeholder="Select state">
                                        <mat-option *ngFor="let state of indianStates" [value]="state">
                                            {{ state }}
                                        </mat-option>
                                    </mat-select>
                                </mat-form-field>
                            </div>
                            <div class="form-item flex-1">
                                <label class="field-label">Pincode<span class="required">*</span></label>
                                <mat-form-field appearance="outline" class="full-width">
                                    <input matInput formControlName="pincode" placeholder="XXXXXX" maxlength="6">
                                </mat-form-field>
                            </div>
                        </div>


                        <div class="photo-upload-section mt-4">
                            <label class="field-label">Hostel Photos</label>
                            <div class="upload-area" (click)="photoInput.click()" matRipple>
                                <input type="file" #photoInput accept="image/*" multiple
                                    (change)="onPhotosSelect($event)" hidden>
                                <div class="upload-icon-box">
                                    <mat-icon>add_a_photo</mat-icon>
                                </div>
                                <p>Click to add hostel photos</p>
                                <span>Upload up to 5 photos (max. 5MB each)</span>
                            </div>

                            <div class="photo-preview-grid mt-3" *ngIf="hostelPhotos.length > 0">
                                <div class="photo-thumb" *ngFor="let photo of hostelPhotos; let i = index">
                                    <img [src]="photo.preview">
                                    <button mat-icon-button class="remove-btn" (click)="removePhoto(i)">
                                        <mat-icon>close</mat-icon>
                                    </button>
                                </div>
                            </div>
                        </div>
                    </form>
                </div>

                <!-- Step 3: License & Property -->
                <div class="step-view" *ngIf="activeStep === 3">
                    <h2 class="section-title">License & Property</h2>
                    <form [formGroup]="licenseForm" class="form-grid">
                        <div class="form-item">
                            <label class="field-label">Property Ownership<span class="required">*</span></label>
                            <mat-form-field appearance="outline" class="full-width">
                                <mat-select formControlName="propertyType" placeholder="Select ownership type">
                                    <mat-option value="Owned">Owned Property</mat-option>
                                    <mat-option value="Rented">Rented Property</mat-option>
                                    <mat-option value="Leased">Leased Property</mat-option>
                                </mat-select>
                            </mat-form-field>
                        </div>

                        <div class="license-toggle-box mt-4">
                            <div class="d-flex align-items-center justify-content-between">
                                <div>
                                    <h4 class="mb-0">Food License (FSSAI)</h4>
                                    <p class="text-muted small mb-0">Required if you provide food service</p>
                                </div>
                                <mat-slide-toggle formControlName="hasFoodLicense" color="primary"></mat-slide-toggle>
                            </div>

                            <div class="fssai-details mt-4" *ngIf="licenseForm.get('hasFoodLicense')?.value" @slideUp>
                                <div class="form-row">
                                    <div class="form-item flex-1">
                                        <label class="field-label">FSSAI Number</label>
                                        <mat-form-field appearance="outline" class="full-width">
                                            <input matInput formControlName="fssaiNumber" placeholder="14-digit number"
                                                maxlength="14">
                                        </mat-form-field>
                                    </div>
                                    <div class="form-item flex-1">
                                        <label class="field-label">Upload Certificate</label>
                                        <div class="file-upload-row">
                                            <input type="file" #fssaiInput accept=".pdf,.jpg,.jpeg,.png"
                                                (change)="onFssaiDocSelect($event)" hidden>
                                            <button mat-stroked-button type="button" class="w-100"
                                                (click)="fssaiInput.click()">
                                                <mat-icon>upload</mat-icon> {{ fssaiDocument ? fssaiDocument.name :
                                                'Choose File' }}
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="terms-acceptance mt-5">
                            <mat-checkbox formControlName="termsAccepted" color="primary">
                                <span class="f-14-r">I agree to the <a href="javascript:void(0)"
                                        class="branded-link">Terms & Conditions</a> and <a href="javascript:void(0)"
                                        class="branded-link">Privacy Policy</a></span>
                            </mat-checkbox>
                        </div>
                    </form>
                </div>
            </main>
        </div>

        <!-- Footer -->
        <div class="wizard-footer">
            <button mat-stroked-button color="warn" class="btn-cancel" (click)="router.navigate(['/dashboard'])">
                <mat-icon>close</mat-icon> Cancel
            </button>
            <div class="footer-actions">
                <button mat-stroked-button (click)="prevStep()" [disabled]="activeStep === 1" class="btn-prev">
                    <mat-icon>chevron_left</mat-icon> Previous
                </button>
                <button mat-flat-button class="btn-next" [disabled]="saving" (click)="nextStep()">
                    <span>{{activeStep === steps.length ? 'Submit Review' : 'Next Step'}}</span>
                    <mat-icon *ngIf="activeStep < steps.length">chevron_right</mat-icon>
                    <mat-icon *ngIf="activeStep === steps.length">send</mat-icon>
                </button>
            </div>
        </div>
    </div>
</div>